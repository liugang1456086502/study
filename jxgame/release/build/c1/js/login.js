!function(t,e,n){n.un,n.uns,n.static;var i=n.class,o=n.getset,s=(n.__newvec,ui.login.popup.AccountUI),r=ui.login.popup.AgreementUI,c=game.core.manager.AudioManager,a=game.core.utils.Auth,u=game.core.base.BaseModel,l=game.core.base.BaseModule,h=game.core.utils.CoreHound,g=game.core.manager.EffectManager,f=(laya.events.Event,game.core.manager.ExternalManager),p=game.core.model.GlobalConfig,d=(game.core.enum.GlobalEnum,game.core.model.GlobalModel),m=laya.utils.Handler,y=(laya.net.Loader,ui.login.LoginUI),b=ui.login.popup.ModifyUI,x=(game.core.enum.Module,ui.login.popup.PhoneUI),A=game.core.manager.PopupManager,O=game.core.utils.Redirect,L=ui.login.popup.RegisterUI,T=game.core.manager.SceneManager,E=game.core.utils.Signal,I=(laya.ani.bone.Skeleton,game.core.utils.Storage),_=game.core.ui.Toast,N=(function(){function t(){}i(t,"game.module.login.enum.LoginEnum"),t.LOGIN="LOGIN",t.AGREEMENT="AGREEMENT",t.PHONE="PHONE",t.ACCOUNT="ACCOUNT",t.MODIFY="MODIFY",t.REGISTER="REGISTER"}(),function(){function t(){}return i(t,"game.module.login.utils.LoginSound"),o(1,t,"initSounds",function(){for(var e=[t.getUrl("bg",!0)],n=["button"];n&&n.length;)e.push(t.getUrl(n.shift()));return e}),t.init=function(){c.start(t.getUrl("bg",!0))},t.effect=function(e){c.playSound(t.getUrl(e))},t.getUrl=function(t,e){return void 0===e&&(e=!1),p.getSoundUrl(t,e)},t}()),G=function(t){function e(){e.__super.call(this)}i(e,"game.module.login.LoginModel",t);var n=e.prototype;return n.init=function(e){t.prototype.init.call(this,e),Boolean(e)&&I.clear(),d.instance.reset()},n.onMessage=function(t){},n.destroy=function(){t.prototype.destroy.call(this),e._instance=null},o(1,e,"instance",function(){return e._instance||(e._instance=new e),e._instance},game.core.base.BaseModel._$SET_instance),e._instance=null,e}(u),M=(function(t){function e(){e.__super.call(this),A.reg("LOGIN","AGREEMENT",v),A.reg("LOGIN","PHONE",R),A.reg("LOGIN","ACCOUNT",S),A.reg("LOGIN","MODIFY",P),A.reg("LOGIN","REGISTER",k),T.reg("LOGIN","LOGIN",M);var t=[{url:"res/login/ui.json",type:"atlas"},{url:"res/login/ani/denglujiaose.png",type:"image"},{url:"res/login/ani/yanhua.png",type:"image"}];this.init(t)}i(e,"game.module.login.LoginModule",t);var n=e.prototype;n.onInit=function(){t.prototype.onInit.call(this),G.instance.init(this.dataSource),T.enter("LOGIN","LOGIN"),this.initComplete()},n.enter=function(e){t.prototype.enter.call(this,e),N.init()},n.remove=function(){t.prototype.remove.call(this)},n.destroy=function(t){void 0===t&&(t=!0),laya.display.Sprite.prototype.destroy.call(this,t),G.instance.destroy()},e.getSoundUrl=function(t,e){return void 0===e&&(e=!1),"res/login/sound/"+t+p.getSoundExt(e)}}(l),function(t){function e(){this.time=0,this.step=0,e.__super.call(this);var t=this;this.btnPhone.on("click",this,this.onPhone),this.btnAccount.on("click",this,this.onAccount),E.on("APP_WX_LOGIN",this,this.onWxLogin),E.on("MODULE_START",this,this.onStart),g.getSkeleton("res/login/ani/denglujiaose.json",m.create(this,function(e){e.x=600,e.y=730,t.denglujiaose.addChild(e)})),g.getSkeleton("res/login/ani/yanhua.json",m.create(this,function(e){e.x=600,e.y=0,t.yanhua.addChild(e)}))}i(e,"game.module.login.scene.LoginView",y);var n=e.prototype;return n.onPhone=function(){h.effect("button"),A.open("LOGIN","PHONE")},n.onAccount=function(){h.effect("button"),A.open("LOGIN","ACCOUNT")},n.onWxLogin=function(t){a.instance.loginByWeixin(t)},n.onStart=function(){O.start()},n.destroy=function(t){void 0===t&&(t=!0),laya.ui.View.prototype.destroy.call(this,t),E.off("APP_WX_LOGIN",this,this.onWxLogin),E.off("MODULE_START",this,this.onStart)},e}()),S=function(t){function e(){e.__super.call(this),this.btnAgree.on("click",this,this.onAgree),this.btnAgreement.on("click",this,this.onAgreement),this.btnModify.on("click",this,this.onModify),this.btnRegister.on("click",this,this.onRegister),this.btnAccout.on("click",this,this.onAccout),this.automatic.on("click",this,this.onAutomatic)}i(e,"game.module.login.popup.AccountView",s);var n=e.prototype;return n.onModify=function(){h.effect("button"),A.open("LOGIN","MODIFY")},n.onAutomatic=function(){h.effect("button")},n.onRegister=function(){h.effect("button"),A.open("LOGIN","REGISTER")},n.onAccout=function(){h.effect("button"),this.acountText.text?this.passText.text?(p.isAutomatic=this.automatic.selected,a.instance.accountLogin(this.acountText.text,this.passText.text)):_.error("请输入密码"):_.error("请输入账号")},n.onAgree=function(){h.effect("button"),this.btnAccout.disabled=!this.btnAgree.selected},n.onAgreement=function(){h.effect("button"),A.open("LOGIN","AGREEMENT")},e}(),v=function(t){function e(){e.__super.call(this),n.loader.load("res/login/agreement.txt",m.create(this,this.onLoaded))}return i(e,"game.module.login.popup.AgreementView",r),e.prototype.onLoaded=function(t){t&&(this.agreement.vScrollBarSkin=null,this.agreement.vScrollBar.elasticBackTime=100,this.agreement.vScrollBar.elasticDistance=100,this.content.text=t)},e}(),P=function(t){function e(){e.__super.call(this)}return i(e,"game.module.login.popup.ModifyView",b),e}(),R=function(t){function e(){this.time=60,e.__super.call(this),this.btnAgree.on("click",this,this.onAgree),this.btnAgreement.on("click",this,this.onAgreement),this.btnKeyObtain.on("click",this,this.onKeyObtain),this.btnPhone.on("click",this,this.onPhone)}i(e,"game.module.login.popup.PhoneView",x);var n=e.prototype;return n.onKeyObtain=function(){h.effect("button"),60==this.time&&(""==this.phoneText.text?_.error("请输入手机号！"):this.isPhone(this.phoneText.text)?(this.timerLoop(1e3,this,this.onTimer),this.btnKeyObtain.disabled=!0,this.btnKeyObtain.label="("+this.time+")重新获取",this.sendCode(this.phoneText.text)):_.error("请输入正确的手机号码！"))},n.onAgreement=function(){h.effect("button"),A.open("LOGIN","AGREEMENT")},n.onAgree=function(){h.effect("button"),this.btnPhone.disabled=!this.btnAgree.selected},n.onPhone=function(){h.effect("button"),""==this.phoneText.text?_.error("请输入手机号！"):this.isPhone(this.phoneText.text)?""==this.keyText.text?_.error("请输入验证码！"):this.loginByPhone(this.phoneText.text,this.keyText.text):_.error("请输入正确的手机号码！")},n.onWeixin=function(){f.login()},n.onTimer=function(){this.time--,this.btnKeyObtain.label="("+this.time+")重新获取",0==this.time&&(this.clearTimer(this,this.onTimer),this.btnKeyObtain.disabled=!1,this.btnKeyObtain.label="获取验证码",this.time=60)},n.isPhone=function(t){return/^[1][3,4,5,7,8][0-9]{9}$/.test(t)},n.sendCode=function(t){a.instance.sendCode(t,m.create(this,function(t){}))},n.loginByPhone=function(t,e){a.instance.loginByPhone(t,e)},e}(),k=function(t){function e(){e.__super.call(this),this.btnConfirm.on("click",this,this.onConfirm)}return i(e,"game.module.login.popup.RegisterView",L),e.prototype.onConfirm=function(){var t=this;h.effect("button"),this.accountText.text?this.psw1.text?this.psw2.text?this.psw1.text!=this.psw2.text?(_.error("两次密码输入不一样"),this.psw1.text="",this.psw2.text=""):a.instance.accountAdd(this.accountText.text,this.psw1.text,m.create(this,function(){t.accountText.text="",t.psw1.text="",t.psw2.text="",G.instance.event("LOGIN")})):_.error("请输入重复密码"):_.error("请输入密码"):_.error("请输入账号")},e}()}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});for(var n in Laya){var i=Laya[n];i&&i.__isclass&&(e[n]=i)}});